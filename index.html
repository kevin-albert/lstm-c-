<!doctype html>
<html>

<head>
  <meta charset="utf8" />
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
  <script type="text/javascript">
    var lstmWorker = new Worker("dist.js");
    var working = false;
    var pending = undefined;

    lstmWorker.addEventListener('message', function (e) {
      working = false;
      console.log('tweet', e.data);
      document.querySelector('#twitter-widget-0').shadowRoot.querySelector(
        'div > blockquote > div.Tweet-body.e-entry-content').innerHTML = formatTweet(e.data);
      if (pending !== undefined) {
        sample(pending);
        pending = undefined;
      }
    }, false);

    function slider(t) {
      $('#temp').text(t);
    }

    function sample(t) {
      if (t === undefined) {
        t = Number($('#slide').val())
      }
      if (working) {
        pending = t;
      } else {
        console.log('sample(' + t + ')');
        working = true;
        lstmWorker.postMessage({
          cmd: 'sample',
          t: t
        });
      }
    }

    function formatTweet(text) {
      // fix literal links
      text = text.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1">$1</a>');
      // replace hashtags w/ links
      text = text.replace(/#([^\s]+)/g, '<a href="https://twitter.com/hashtag/$1?src=hash">#$1</a>');
      // replace usernames w/ links
      text = text.replace(/@([^\s]+)/g, '<a href="https://twitter.com/$1>@$1</a>');
      return text;
    }
  </script>
</head>

<body>
  <div style="width: 500px; max-width: 100%; margin: 40px 0">
    Adjust softmax (<span id="temp">1.5</span>)<br>
    <input style="width: 100%" id="slide" type="range" min="0.1" max="4" step="0.01" value="1.5" oninput="slider(this.value)"
      onchange="sample(this.value)" />
    <button onmousedown="sample()">Refresh</button>
  </div>
  <br/>
  <blockquote class="twitter-tweet" data-lang="en">
    <p lang="en" dir="ltr">My twitter has become so powerful that I can actually make my enemies tell the truth.</p>&mdash; Donald J. Trump (@realDonaldTrump)
    <a href="https://twitter.com/realDonaldTrump/status/258584864163500033">October 17, 2012</a></blockquote>
  <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>



  <!--<div style="border-radius: 2px; border: 1px solid rgb(225,232,237); width: 500px; max-width: 100%; min-width: 220px;">
    <div style="padding: 20px 20px 11.6px 20px; font-family: Helvetica, Roboto,  Segoe UI, Calibri, sans-serif; font-size: 16px; color: rgb(28, 32, 34)">
      <div>
        <img style="width: 36px; height: 36px; float: left; display: block; padding-right: 9px" src="https://pbs.twimg.com/profile_images/1980294624/DJT_Headshot_V2_bigger.jpg "
        />
        <div style="float: left; width: 100%">
          <span style="font-size: 16px; font-weight: bold; ">Donald J. Trump</span>
          <img style="width: 1em; height: 1em;" src="verified.png " />
          <br />
          <span style="font-size: 14px; color: rgb(105, 120, 130) ">@realDonaldTrump</span>
        </div>
      </div>
      <br />
      <div>bing bing bong bong bing bing bing</div>
    </div>

  </div>-->
  <!--<blockquote class="twitter-tweet " data-cards="hidden " data-lang="en ">
    <p lang="en " dir="ltr ">We need equal representation from both universes.
      <a href="https://twitter.com/hashtag/StarWarsDay?src=hash ">#StarWarsDay</a>
      <a href="https://twitter.com/hashtag/MayThe4thBeWithYou?src=hash ">#MayThe4thBeWithYou</a>
      <a href="https://twitter.com/StarTrek ">@StarTrek</a>
      <a href="https://twitter.com/levarburton ">@levarburton</a>
      <a href="https://t.co/enetlmpc7G ">pic.twitter.com/enetlmpc7G</a></p>
    &mdash; David Rancken (@rancken) <a href="#lame ">May 4, 2017</a>
  </blockquote>
  <script async src="//platform.twitter.com/widgets.js " charset="utf-8 "></script>-->



</body>

</html>
